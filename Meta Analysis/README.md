# Three Level Meta Analysis

In this article, we aim to evaluate the association between indicators (such as BMI, weight, and height) and the risk of myopia or high myopia. Several statistical methods are applied to achieve this goal.

Some studies report raw frequency data instead of effect sizes like odds ratios. The [**calculating OR from frequency**](https://github.com/Sh-mahmoudi/Article/blob/main/Meta%20Analysis/calculate%20OR%20from%20frequency.R) script calculates odds ratios and their 95% confidence intervals for each exposure group using the reported frequencies.

Most studies reported odds ratios for categories of exposure rather than continuous variables, so a linear dose-response meta-analysis approach was used to produce a single OR per study. The [**calculating one OR from four OR**](https://github.com/Sh-mahmoudi/Article/blob/main/Meta%20Analysis/calculate%20one%20OR%20from%20four%20OR.R) script estimates the midpoint of each category, adjusts open-ended categories, and computes ORs and 95% CIs for a 1-unit increase in exposure for each data point. Using the dosresmeta package in R, it then fits a meta-regression model to estimate the risk change associated with a one-unit increase in exposure.
The [**Calculate OR from multiple ORs when we have mean of BMI**](https://github.com/Sh-mahmoudi/Article/blob/main/Meta%20Analysis/calculate%20OR%20from%20multiple%20OR%20when%20we%20have%20mean%20of%20BMI.R) script applies a linear dose-response meta-analysis approach to studies that reported the mean of exposure instead of minimum and maximum for each category.

After converting all ORs to continuous exposure values and since some studies reported multiple ORs (e.g., stratified by age or gender) we performed a three-level meta-analysis. The [**Three-Level Meta-Analysis and Meta-Regression**](https://github.com/Sh-mahmoudi/Article/blob/main/Meta%20Analysis/Three%20Level%20Meta%20analysis%20and%20Meta%20Regression.R) script, using the {metafor} package, identifies nested data structures where multiple effect sizes are reported and applies a three-level random-effects meta-analysis. Additionally, random-effects meta-regressions were performed for different subgroups (e.g., BMI & Myopia).
A grouped forest plot that displays individual study effect sizes (odds ratios), grouped by subcategories, is generated using the [**Overall Forest Plot**](https://github.com/Sh-mahmoudi/Article/blob/main/Meta%20Analysis/Overall%20Forest%20Plot.R) script. A three-level random-effects meta-analysis (rma.mv) is used to account for within- and between-study variance. Subgroup summary effects are displayed as diamonds with confidence intervals, and an overall combined summary effect is shown at the bottom. The output is saved as a high-resolution PDF.

The [**Forest Plot for Different Subgroups**](https://github.com/Sh-mahmoudi/Article/blob/main/Meta%20Analysis/Forest%20Plot%20for%20Different%20Subgroup.R) script generates three forest plots for exposure types (e.g., BMI, Weight, Height) grouped by outcome (e.g., Myopia vs. High Myopia). We used random-effects multilevel meta-analysis for these plots as well. Subgroup-specific summary and overall effect size diamonds are included. The number of rows in each plot is used to adjust the height (pdf(..., height = max(4, 0.3 * nrow(...)))) for better readability. The output is saved as three high-resolution PDFs.
Since there isn’t a practical way to calculate publication bias and perform sensitivity analysis for a three-level meta-analysis, we performed a transformation to allow for a two-level meta-analysis while still accounting for the dependence of effect sizes within studies. The [**Robust Variance Estimation (RVE)**](https://github.com/Sh-mahmoudi/Article/blob/main/Meta%20Analysis/Robust%20Variance%20Estimation%20(RVE)%20.R) script runs a robust variance estimation meta-analysis to combine multiple ORs within a study into one, while accounting for non-independent effect sizes.

The[**Subgroup Two-Level Meta-Analysis Diagnostics**](https://github.com/Sh-mahmoudi/Article/blob/main/Meta%20Analysis/Subgroup%20Two%20Level%20Meta%20Analysis%20Diagnostics.R)script performs diagnostic checks for five exposure–outcome subgroups in our dataset. It includes a random-effects two-level meta-analysis, funnel plots (saved to PDF), leave-one-out sensitivity analysis, and publication bias tests (Egger’s test and Begg’s test). The script includes built-in safeguards for inconsistent confidence intervals and missing standard errors, and dynamically skips subgroups with fewer than 3 studies.
